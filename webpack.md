# Webpack  ğŸ•¸

> **0. æœ‰å“ªäº›å¸¸è§çš„ Loader?**

* `row-loader` : åŠ åœ¨åŸå§‹æ–‡ä»¶åŸå§‹å†…å®¹ (utf-8)
* `file-loader` : æŠŠæ–‡ä»¶è¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œåœ¨ä»£ç ä¸­é€šè¿‡ç›¸å¯¹ URL å»é¥®ç”¨è¾“å‡ºçš„æ–‡ä»¶
* `url-loader` : ä¸ file-loader ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯ç”¨æˆ·å¯ä»¥è®¾ç½®ä¸€ä¸ªé˜ˆå€¼ï¼Œå¤§äºé˜ˆå€¼ä¼šäº¤ç»™ file-loader å¤„ç†ï¼Œå°äºé˜ˆå€¼æ—¶è¿”å›æ–‡ä»¶ base64 å½¢å¼ç¼–ç  (å¤„ç†å›¾ç‰‡å’Œå­—ä½“)
* `source-map-loader`: åŠ è½½é¢å¤–çš„ Source Map æ–‡ä»¶ï¼Œä»¥æ–¹ä¾¿æ–­ç‚¹è°ƒè¯•
* `svg-inline-loader`: å°†å‹ç¼©åçš„ SVG å†…å®¹æ³¨å…¥ä»£ç ä¸­
* `image-loader`: åŠ è½½å¹¶ä¸”å‹ç¼©å›¾ç‰‡æ–‡ä»¶
* `json-loader`: åŠ è½½ JSON æ–‡ä»¶ï¼ˆé»˜è®¤åŒ…å«ï¼‰
* `handlebars-loader`: å°† Handlebars æ¨¡ç‰ˆç¼–è¯‘æˆå‡½æ•°å¹¶è¿”å›
* `babel-loader`: æŠŠ ES6 è½¬æ¢æˆ ES5
* `ts-loader`: å°† TypeScript è½¬æ¢æˆ JavaScript
* `awesome-typescript-loader`: å°† TypeScript è½¬æ¢æˆ JavaScriptï¼Œæ€§èƒ½ä¼˜äº ts-loader
* `sass-loader`: å°†SCSS/SASSä»£ç è½¬æ¢æˆCSS
* `css-loader`: åŠ è½½ CSSï¼Œæ”¯æŒæ¨¡å—åŒ–ã€å‹ç¼©ã€æ–‡ä»¶å¯¼å…¥ç­‰ç‰¹æ€§
* `style-loader`: é€šè¿‡\<style\>æ ‡ç­¾æŠŠ css åŠ è½½åˆ° DOM ä¸­
* `postcss-loader`: æ‰©å±• CSS è¯­æ³•ï¼Œä½¿ç”¨ä¸‹ä¸€ä»£ CSSï¼Œå¯ä»¥é…åˆ autoprefixer æ’ä»¶è‡ªåŠ¨è¡¥é½ CSS3 å‰ç¼€
* `eslint-loader`: é€šè¿‡ ESLint æ£€æŸ¥ JavaScript ä»£ç 
* `tslint-loader`: é€šè¿‡ TSLintæ£€æŸ¥ TypeScript ä»£ç 
* `mocha-loader`: åŠ è½½ Mocha æµ‹è¯•ç”¨ä¾‹çš„ä»£ç 
* `coverjs-loader`: è®¡ç®—æµ‹è¯•çš„è¦†ç›–ç‡
* `vue-loader`: åŠ è½½ Vue å•æ–‡ä»¶ç»„ä»¶
* `i18n-loader`: å›½é™…åŒ–
* `cache-loader`: å¯ä»¥åœ¨ä¸€äº›æ€§èƒ½å¼€é”€è¾ƒå¤§çš„ Loader ä¹‹å‰æ·»åŠ ï¼Œç›®çš„æ˜¯å°†ç»“æœç¼“å­˜åˆ°ç£ç›˜é‡Œ

> **1. æœ‰å“ªäº›å¸¸è§çš„ Plugin?**
* `speed-measure-webpack-plugin`: å¯ä»¥çœ‹åˆ°æ¯ä¸ª Loader å’Œ Plugin æ‰§è¡Œè€—æ—¶ (æ•´ä¸ªæ‰“åŒ…è€—æ—¶ã€æ¯ä¸ª Plugin å’Œ Loader è€—æ—¶)
* `SplitChunksPlugin`: å°†å…¬å…±ä¾èµ–é¡¹æå–åˆ°ç°æœ‰çš„ entry chunk æˆ–å…¨æ–°çš„ä»£ç å—ä¸­
* `webpack-bundle-analyzer`: å¯è§†åŒ– Webpack è¾“å‡ºæ–‡ä»¶çš„ä½“ç§¯ (ä¸šåŠ¡ç»„ä»¶ã€ä¾èµ–ç¬¬ä¸‰æ–¹æ¨¡å—)
* `ignore-plugin`: ä» bundle ä¸­æ’é™¤æŸäº›æ¨¡å—
* `ModuleConcatenationPlugin`: æå‡æ‰€æœ‰æ¨¡å—åˆ°ä¸€ä¸ªé—­åŒ…ä¸­ï¼Œæå‡ä½ çš„ä»£ç åœ¨æµè§ˆå™¨ä¸­çš„æ‰§è¡Œé€Ÿåº¦ã€‚
* `html-webpack-plugin`: åˆ›å»º HTML æ–‡ä»¶
* `web-webpack-plugin`: å¯æ–¹ä¾¿åœ°ä¸ºå•é¡µåº”ç”¨è¾“å‡º HTMLï¼Œæ¯” html-webpack-plugin å¥½ç”¨
* `terser-webpack-plugin`: å‹ç¼© JSï¼Œæ”¯æŒ ES6
* `mini-css-extract-plugin`: åˆ†ç¦»æ ·å¼æ–‡ä»¶ï¼ŒCSS æå–ä¸ºç‹¬ç«‹æ–‡ä»¶ï¼Œæ”¯æŒæŒ‰éœ€åŠ è½½ (æ›¿ä»£extract-text-webpack-plugin)
* `serviceworker-webpack-plugin`: ä¸ºç½‘é¡µåº”ç”¨å¢åŠ ç¦»çº¿ç¼“å­˜åŠŸèƒ½
* `clean-webpack-plugin`: ç›®å½•æ¸…ç†

> **2. Loaderå’ŒPluginçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ**

`Loader` æœ¬è´¨æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨è¯¥å‡½æ•°ä¸­å¯¹æ¥æ”¶åˆ°çš„å†…å®¹è¿›è¡Œè½¬æ¢ï¼Œè¿”å›è½¬æ¢åçš„ç»“æœã€‚å› ä¸º Webpack åªè®¤è¯† JavaScriptï¼Œæ‰€ä»¥ Loader å°±æˆäº†ç¿»è¯‘å®˜ï¼Œå¯¹å…¶ä»–ç±»å‹çš„èµ„æºè¿›è¡Œè½¬è¯‘çš„é¢„å¤„ç†å·¥ä½œã€‚

`Plugin` å°±æ˜¯æ’ä»¶ï¼ŒåŸºäºäº‹ä»¶æµæ¡†æ¶ `Tapable`, æ’ä»¶å¯ä»¥æ‰©å±• Webpack åŠŸèƒ½ï¼Œåœ¨ Webpack è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¼šå¹¿æ’­å‡ºè®¸å¤šäº‹ä»¶ï¼ŒPlugin å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡ Webpack æä¾›çš„ API æ”¹å˜è¾“å‡ºç»“æœã€‚

`Loader` åœ¨ module.rules ä¸­é…ç½®ï¼Œä½œä¸ºæ¨¡å—è§£æè§„åˆ™ï¼Œç±»å‹ä¸ºæ•°ç»„ã€‚æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ª Objectï¼Œå†…éƒ¨åŒ…å«äº† test(ç±»å‹æ–‡ä»¶)ã€loaderã€options(å‚æ•°) ç­‰å±æ€§ã€‚

`Plugin` åœ¨ plugins ä¸­å•ç‹¬é…ç½®ï¼Œç±»å‹ä¸ºæ•°ç»„ï¼Œæ¯ä¸€é¡¹æ˜¯ä¸€ä¸ª Plugin çš„å®ä¾‹ï¼Œå‚æ•°éƒ½é€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥ã€‚

> **3. Webpackæ„å»ºæµç¨‹**
Webpack çš„è¿è¡Œæµç¨‹æ˜¯ä¸€ä¸ªä¸²è¡Œçš„è¿‡ç¨‹ï¼Œä»å¯åŠ¨åˆ°ç»“æŸä¼šä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æµç¨‹ï¼š

- `åˆå§‹åŒ–å‚æ•°`ï¼šä»é…ç½®æ–‡ä»¶å’Œ Shell è¯­å¥ä¸­è¯»å–ä¸åˆå¹¶å‚æ•°ï¼Œå¾—å‡ºæœ€ç»ˆçš„å‚æ•°
- `å¼€å§‹ç¼–è¯‘`ï¼šç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ– Compiler å¯¹è±¡ï¼ŒåŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶ï¼Œæ‰§è¡Œå¯¹è±¡çš„ run æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘
- `ç¡®å®šå…¥å£`ï¼šæ ¹æ®é…ç½®ä¸­çš„ entry æ‰¾å‡ºæ‰€æœ‰çš„å…¥å£æ–‡ä»¶
- `ç¼–è¯‘æ¨¡å—`ï¼šä»å…¥å£æ–‡ä»¶å‡ºå‘ï¼Œè°ƒç”¨æ‰€æœ‰é…ç½®çš„ Loader å¯¹æ¨¡å—è¿›è¡Œç¿»è¯‘ï¼Œå†æ‰¾å‡ºè¯¥æ¨¡å—ä¾èµ–çš„æ¨¡å—ï¼Œå†é€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡äº†æœ¬æ­¥éª¤çš„å¤„ç†
- `å®Œæˆæ¨¡å—ç¼–è¯‘`ï¼šåœ¨ç»è¿‡ç¬¬4æ­¥ä½¿ç”¨ Loader ç¿»è¯‘å®Œæ‰€æœ‰æ¨¡å—åï¼Œå¾—åˆ°äº†æ¯ä¸ªæ¨¡å—è¢«ç¿»è¯‘åçš„æœ€ç»ˆå†…å®¹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»
- `è¾“å‡ºèµ„æº`ï¼šæ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç»„è£…æˆä¸€ä¸ªä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„ Chunkï¼Œå†æŠŠæ¯ä¸ª Chunk è½¬æ¢æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨ï¼Œè¿™æ­¥æ˜¯å¯ä»¥ä¿®æ”¹è¾“å‡ºå†…å®¹çš„æœ€åæœºä¼š
- `è¾“å‡ºå®Œæˆ`ï¼šåœ¨ç¡®å®šå¥½è¾“å‡ºå†…å®¹åï¼Œæ ¹æ®é…ç½®ç¡®å®šè¾“å‡ºçš„è·¯å¾„å’Œæ–‡ä»¶åï¼ŒæŠŠæ–‡ä»¶å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿ

åœ¨ä»¥ä¸Šè¿‡ç¨‹ä¸­ï¼ŒWebpack ä¼šåœ¨ç‰¹å®šçš„æ—¶é—´ç‚¹å¹¿æ’­å‡ºç‰¹å®šçš„äº‹ä»¶ï¼Œæ’ä»¶åœ¨ç›‘å¬åˆ°æ„Ÿå…´è¶£çš„äº‹ä»¶åä¼šæ‰§è¡Œç‰¹å®šçš„é€»è¾‘ï¼Œå¹¶ä¸”æ’ä»¶å¯ä»¥è°ƒç”¨ Webpack æä¾›çš„ API æ”¹å˜ Webpack çš„è¿è¡Œç»“æœã€‚

ç®€å•è¯´

`åˆå§‹åŒ–`ï¼šå¯åŠ¨æ„å»ºï¼Œè¯»å–ä¸åˆå¹¶é…ç½®å‚æ•°ï¼ŒåŠ è½½ Pluginï¼Œå®ä¾‹åŒ– Compiler
`ç¼–è¯‘`ï¼šä» Entry å‡ºå‘ï¼Œé’ˆå¯¹æ¯ä¸ª Module ä¸²è¡Œè°ƒç”¨å¯¹åº”çš„ Loader å»ç¿»è¯‘æ–‡ä»¶çš„å†…å®¹ï¼Œå†æ‰¾åˆ°è¯¥ Module ä¾èµ–çš„ Moduleï¼Œé€’å½’åœ°è¿›è¡Œç¼–è¯‘å¤„ç†
`è¾“å‡º`ï¼šå°†ç¼–è¯‘åçš„ Module ç»„åˆæˆ Chunkï¼Œå°† Chunk è½¬æ¢æˆæ–‡ä»¶ï¼Œè¾“å‡ºåˆ°æ–‡ä»¶ç³»ç»Ÿä¸­

> **4. ä½¿ç”¨webpackå¼€å‘æ—¶ï¼Œä½ ç”¨è¿‡å“ªäº›å¯ä»¥æé«˜æ•ˆç‡çš„æ’ä»¶ï¼Ÿ**
- `webpack-dashboard`: å¯ä»¥æ›´å‹å¥½åœ°å±•ç¤ºç›¸å…³å¤§å®ä¿¡æ¯
- `webpack-merge`: æå–å…¬å…±é…ç½®ï¼Œå‡å°‘é‡å¤é…ç½®ä»£ç 
- `speed-measure-webpack-plugin`: åˆ†æå‡ºæ‰“åŒ…è¿‡ç¨‹ä¸­ Loader å’Œ Plugin çš„è€—æ—¶ï¼Œæœ‰åŠ©äºæ‰¾åˆ°æ„å»ºè¿‡ç¨‹ä¸­çš„æ€§èƒ½ç“¶é¢ˆã€‚
- `size-plugin`: ç›‘æ§èµ„æºä½“ç§¯å˜åŒ–ï¼Œå°½æ—©å‘ç°é—®é¢˜
- `HotModuleReplaceMentPlugin`: æ¨¡å—çƒ­æ›¿æ¢

> **5. source map æ¨¡å¼**

**å¼€å‘ç¯å¢ƒæ¨èï¼š**

`cheap-module-eval-source-map`

**ç”Ÿäº§ç¯å¢ƒæ¨èï¼š**

`cheap-module-source-map `

ï¼ˆè¿™ä¹Ÿæ˜¯ä¸‹ç‰ˆæœ¬ webpack ä½¿ç”¨-då‘½ä»¤å¯åŠ¨ debug æ¨¡å¼æ—¶çš„é»˜è®¤é€‰é¡¹ï¼‰

**åŸå› å¦‚ä¸‹ï¼š**

1. ä½¿ç”¨ cheap æ¨¡å¼å¯ä»¥å¤§å¹…æé«˜ souremap ç”Ÿæˆçš„æ•ˆç‡ã€‚å¤§éƒ¨åˆ†æƒ…å†µæˆ‘ä»¬è°ƒè¯•å¹¶ä¸å…³å¿ƒåˆ—ä¿¡æ¯ï¼Œè€Œä¸”å°±ç®— sourcemap æ²¡æœ‰åˆ—ï¼Œæœ‰äº›æµè§ˆå™¨å¼•æ“ï¼ˆä¾‹å¦‚ v8ï¼‰ ä¹Ÿä¼šç»™å‡ºåˆ—ä¿¡æ¯ã€‚
2. ä½¿ç”¨ eval æ–¹å¼å¯å¤§å¹…æé«˜æŒç»­æ„å»ºæ•ˆç‡ã€‚å‚è€ƒå®˜æ–¹æ–‡æ¡£æä¾›çš„é€Ÿåº¦å¯¹æ¯”è¡¨æ ¼å¯ä»¥çœ‹åˆ° eval æ¨¡å¼çš„ç¼–è¯‘é€Ÿåº¦å¾ˆå¿«ã€‚
3. ä½¿ç”¨ module å¯æ”¯æŒ babel è¿™ç§é¢„ç¼–è¯‘å·¥å…·ï¼ˆåœ¨ webpack é‡Œåšä¸º loader ä½¿ç”¨ï¼‰ã€‚
4. ä½¿ç”¨ eval-source-map æ¨¡å¼å¯ä»¥å‡å°‘ç½‘ç»œè¯·æ±‚ã€‚è¿™ç§æ¨¡å¼å¼€å¯ DataUrl æœ¬èº«åŒ…å«å®Œæ•´ sourcemap ä¿¡æ¯ï¼Œå¹¶ä¸éœ€è¦åƒ sourceURL é‚£æ ·ï¼Œæµè§ˆå™¨éœ€è¦å‘é€ä¸€ä¸ªå®Œæ•´è¯·æ±‚å»è·å– sourcemap æ–‡ä»¶ï¼Œè¿™ä¼šç•¥å¾®æé«˜ç‚¹æ•ˆç‡ã€‚è€Œç”Ÿäº§ç¯å¢ƒä¸­åˆ™ä¸å®œç”¨ evalï¼Œè¿™æ ·ä¼šè®©æ–‡ä»¶å˜å¾—æå¤§ã€‚

**SourceMap æ¨¡å¼æ•ˆç‡å¯¹æ¯”å›¾**
![SourceMap æ¨¡å¼æ•ˆç‡å¯¹æ¯”å›¾](https://lc-api-gold-cdn.xitu.io/a2e245898b08cdc389a2.jpeg?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

> **6. source map æ¨¡å—æ‰“åŒ…åŸç†çŸ¥é“å—ï¼Ÿ**

Webpack å®é™…ä¸Šä¸ºæ¯ä¸ªæ¨¡å—åˆ›é€ äº†ä¸€ä¸ªå¯ä»¥å¯¼å‡ºå’Œå¯¼å…¥çš„ç¯å¢ƒï¼Œæœ¬è´¨ä¸Šå¹¶æ²¡æœ‰ä¿®æ”¹ ä»£ç çš„æ‰§è¡Œé€»è¾‘ï¼Œä»£ç æ‰§è¡Œé¡ºåºä¸æ¨¡å—åŠ è½½é¡ºåºä¹Ÿå®Œå…¨ä¸€è‡´ã€‚

>  **7. æ–‡ä»¶ç›‘å¬åŸç†**

å‘ç°æºç å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè‡ªåŠ¨é‡æ–°æ„å»ºå‡ºæ–°çš„è¾“å‡ºæ–‡ä»¶

Webpack å¼€å¯ç›‘å¬æ¨¡å¼ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š
- å¯åŠ¨ webpack å‘½ä»¤æ—¶ï¼Œå¸¦ä¸Š --watch å‚æ•°
- åœ¨é…ç½® webpack.config.js ä¸­è®¾ç½® watch: true

ç¼ºç‚¹ï¼šæ¯æ¬¡éœ€è¦æ‰‹åŠ¨åˆ·æ–°æµè§ˆå™¨

åŸç†ï¼šè½®è¯¢åˆ¤æ–­æ–‡ä»¶çš„æœ€åç¼–è¾‘äº‹ä»¶æ˜¯å¦å˜åŒ–ï¼Œå¦‚æœæŸä¸ªæ–‡ä»¶å‘ç”Ÿäº†å˜åŒ–ï¼Œå¹¶ä¸ä¼šç«‹åˆ»å‘Šè¯‰ç›‘å¬ç€ï¼Œè€Œæ˜¯å…ˆç¼“å­˜èµ·æ¥ï¼Œç­‰ `aggregateTimeout` åå†æ‰§è¡Œ

```javascript
module.export = {
  // é»˜è®¤false,ä¹Ÿå°±æ˜¯ä¸å¼€å¯
  watch: true,
  // åªæœ‰å¼€å¯ç›‘å¬æ¨¡å¼æ—¶ï¼ŒwatchOptionsæ‰æœ‰æ„ä¹‰
  watchOptions: {
    // é»˜è®¤ä¸ºç©ºï¼Œä¸ç›‘å¬çš„æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹ï¼Œæ”¯æŒæ­£åˆ™åŒ¹é…
    ignore: /node_modules/,
    // ç›‘å¬åˆ°å˜åŒ–å‘ç”Ÿåä¼šç­‰300mså†å»æ‰§è¡Œï¼Œé»˜è®¤300ms
    aggregateTimeout: 300,
    // åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å‘ç”Ÿå˜åŒ–æ˜¯é€šè¿‡ä¸åœè¯¢é—®ç³»ç»ŸæŒ‡å®šæ–‡ä»¶æœ‰æ²¡æœ‰å˜åŒ–å®ç°çš„ï¼Œé»˜è®¤æ¯ç§’é—®1000æ¬¡
    poll: 1000
  }
}
```

> **8. è¯´ä¸€ä¸‹ Webpack çš„çƒ­æ›´æ–°åŸç†å§**

`Webpack` çš„çƒ­æ›´æ–°åˆç§°çƒ­æ›¿æ¢(```Hot Module Replacement```)ï¼Œç¼©å†™ä¸º HMRã€‚è¿™ä¸ªæœºåˆ¶å¯ä»¥åšåˆ°ä¸ç”¨åˆ·æ–°æµè§ˆå™¨è€Œå°†æ–°å˜æ›´çš„æ¨¡å—æ›¿æ¢æ‰æ—§çš„æ¨¡å—ã€‚

HMR çš„æ ¸å¿ƒå°±æ˜¯å®¢æˆ·ç«¯ä»æœåŠ¡ç«¯æ‹‰å–æ›´æ–°åçš„æ–‡ä»¶ï¼Œå‡†ç¡®çš„è¯´æ˜¯ chunk diff(chunk éœ€è¦æ›´æ–°çš„éƒ¨åˆ†)ï¼Œå®é™…ä¸Š WDS ä¸æµè§ˆå™¨ä¹‹é—´ç»´æŠ¤äº†ä¸€ä¸ª `WebSocket`ï¼Œå½“æœ¬åœ°èµ„æºå‘ç”Ÿå˜åŒ–æ—¶ï¼ŒWDS ä¼šå‘æµè§ˆå™¨æ¨é€æ›´æ–°ï¼Œå¹¶å¸¦ä¸Šæ„å»ºæ—¶çš„ hashï¼Œè®©å®¢æˆ·ç«¯ä¸ä¸Šä¸€æ¬¡èµ„æºè¿›è¡Œå¯¹æ¯”ã€‚å®¢æˆ·ç«¯å¯¹æ¯”å·®å¼‚åä¼šå‘ WDS å‘èµ· `Ajax` è¯·æ±‚è·å–æ›´æ”¹å†…å®¹ï¼ˆæ–‡ä»¶åˆ—è¡¨ã€hashï¼‰ï¼Œè¿™æ ·å®¢æˆ·ç«¯å°±å†å€ŸåŠ©è¿™äº›ä¿¡æ¯ç»§ç»­å‘ WDS å‘èµ· `jsonp` è¯·æ±‚è·å–è¯¥ chunk å¢é‡æ›´æ–°ã€‚

åç»­çš„éƒ¨åˆ†(æ‹¿åˆ°å¢é‡æ›´æ–°ä¹‹åå¦‚ä½•å¤„ç†ï¼Ÿå“ªäº›çŠ¶æ€è¯¥ä¿ç•™ï¼Ÿå“ªäº›åˆéœ€è¦æ›´æ–°ï¼Ÿ)ç”± `HotModulePlugin` æ¥å®Œæˆï¼Œæä¾›äº†ç›¸å…³ API ä»¥ä¾›å¼€å‘è€…é’ˆå¯¹è‡ªèº«åœºæ™¯è¿›è¡Œå¤„ç†ï¼Œåƒ`react-hot-loader` å’Œ `vue-loader` éƒ½æ˜¯å€ŸåŠ©è¿™äº› API å®ç° HMRã€‚

> **9. å¦‚ä½•å¯¹bundleä½“ç§¯è¿›è¡Œç›‘æ§å’Œåˆ†æï¼Ÿ**

VSCode ä¸­æœ‰ä¸€ä¸ªæ’ä»¶ `Import Cost` å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¯¹å¼•å…¥æ¨¡å—çš„å¤§å°è¿›è¡Œå®æ—¶ç›‘æµ‹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ `webpack-bundle-analyzer` ç”Ÿæˆ bundle çš„æ¨¡å—ç»„æˆå›¾ï¼Œæ˜¾ç¤ºæ‰€å ä½“ç§¯ã€‚

`bundlesize` å·¥å…·åŒ…å¯ä»¥è¿›è¡Œè‡ªåŠ¨åŒ–èµ„æºä½“ç§¯ç›‘æ§ã€‚

> **10. æ–‡ä»¶æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆç”¨ï¼Ÿ**

æ–‡ä»¶æŒ‡çº¹æ˜¯æ‰“åŒ…åè¾“å‡ºçš„æ–‡ä»¶ååç¼€ã€‚

- `Hash`: æ¯ä¸ªæ„å»ºè¿‡ç¨‹ç”Ÿæˆçš„å”¯ä¸€ hash
- `Chunkhash`: åŸºäºæ¯ä¸ª chunk å†…å®¹ç”Ÿæˆçš„ hash
- `Contenthash`: æ ¹æ®æ–‡ä»¶å†…å®¹ç”Ÿæˆçš„ hash

å ä½ç¬¦åç§°åŠå«ä¹‰

- `ext` èµ„æºåç¼€å
- `name` æ–‡ä»¶åç§°
- `path` æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„
- `folder` æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹
- `emoji` ä¸€ä¸ªéšæœºçš„æŒ‡ä»£æ–‡ä»¶å†…å®¹çš„emoji

<center style="font-weight:bold;text-decoration:underline">JS æ–‡ä»¶æŒ‡çº¹è®¾ç½®</center>
è®¾ç½® output çš„ filenanmeï¼Œç”¨ chunkhash

```
module.exports = {
  entry: {
    app: './src/app.js',
    search: './src/search.js
  },
  output: {
    filename: '[name][chunkhash:8].js',
    path
  }
}
```

<center style="font-weight:bold;text-decoration:underline">CSS æ–‡ä»¶æŒ‡çº¹è®¾ç½®</center>
è®¾ç½® MiniCssExtractPlugin çš„ filenameï¼Œä½¿ç”¨ contenthashã€‚

```
module.exports = {
  entry: {
    app: './src/app.js',
    search: './src/search.js
  },
  output: {
    filename: '[name][chunkhash:8].js',
    path
  },
  plugins: [
    new MiniCssExtractPlugin({
      filename: `[name][contenthash:8].css`
    })
  ]
}
```
<center style="font-weight:bold;text-decoration:underline">å›¾ç‰‡æ–‡ä»¶æŒ‡çº¹è®¾ç½®</center>
è®¾ç½®file-loaderçš„nameï¼Œä½¿ç”¨hashã€‚

```
module.exports = {
  entry: {
    app: './src/app.js',
    search: './src/search.js
  },
  output: {
    filename: '[name][chunkhash:8].js',
    path
  },
  module: {
    rules: [{
      test: /\.(png|svg|jpg|gif)$/,
      use: [{
        loader: 'file-loader',
        options: {
          name: 'img/[name][hash:8].[ext]'
        }
      }]
    }]
  },
  plugins: [
    new MiniCssExtractPlugin({
      filename: `[name][contenthash:8].css`
    })
  ]
}
```

> **11.åœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œé…ç½®æ–‡ä»¶ä¸Šç™¾è¡Œä¹ƒæ˜¯å¸¸äº‹ï¼Œå¦‚ä½•ä¿è¯å„ä¸ªloaderæŒ‰ç…§é¢„æƒ³æ–¹å¼å·¥ä½œï¼Ÿ**

å¯ä»¥ä½¿ç”¨ `enforce` å¼ºåˆ¶æ‰§è¡Œ `loader` çš„ä½œç”¨é¡ºåºï¼Œ`pre` ä»£è¡¨åœ¨æ‰€æœ‰æ­£å¸¸ `loader` ä¹‹å‰æ‰§è¡Œï¼Œ`post` æ˜¯æ‰€æœ‰ `loader` ä¹‹åæ‰§è¡Œã€‚

> **12.å¦‚ä½•ä¼˜åŒ– Webpack çš„æ„å»ºé€Ÿåº¦ï¼Ÿ**

- `å¤šè¿›ç¨‹å‹ç¼©`: terser-webpack-plugin å¼€å¯ parallel
- `æå–é¡µé¢å…¬å…±èµ„æº`:
  - ä½¿ç”¨ html-webpack-externals-pluginï¼Œå°†åŸºç¡€åŒ…é€šè¿‡CDNå¼•å…¥ï¼Œä¸æ‰“å…¥ bundle ä¸­
  - ä½¿ç”¨ SplitChunksPlugin è¿›è¡Œï¼ˆå…¬å…±è„šæœ¬ã€åŸºç¡€åŒ…ã€é¡µé¢å…¬å…±æ–‡ä»¶ï¼‰åˆ†ç¦»
- `DLL` : ä½¿ç”¨ DllPlugins è¿›è¡Œåˆ†åŒ…ï¼Œä½¿ç”¨ DllReferencePluginï¼ˆç´¢å¼•é“¾æ¥ï¼‰å¯¹ manifest.json å¼•ç”¨ï¼Œè®©ä¸€äº›åŸºæœ¬ä¸ä¼šæ”¹åŠ¨çš„ä»£ç å…ˆæ‰“åŒ…æˆé™æ€èµ„æºï¼Œé¿å…åå¤ç¼–è¯‘æµªè´¹æ—¶é—´
- `åˆ©ç”¨ç¼“å­˜æå‡äºŒæ¬¡æ„å»ºé€Ÿåº¦`:
  - babel-loader å¼€å¯ç¼“å­˜
  - terser-webpack-plugin å¼€å¯ç¼“å­˜
  - ä½¿ç”¨ cache-loader
- `tree-shaking`:
  - æ‰“åŒ…è¿‡ç¨‹ä¸­æ£€æµ‹å·¥ç¨‹ä¸­æ²¡æœ‰å¼•ç”¨è¿‡çš„æ¨¡å—å¹¶è¿›è¡Œæ ‡è®°ï¼Œåœ¨èµ„æºå‹ç¼©æ—¶å°†å®ƒä»¬ä»æœ€ç»ˆçš„bundleä¸­å»æ‰(åªèƒ½å¯¹ES6 Modlueç”Ÿæ•ˆ) å¼€å‘ä¸­å°½å¯èƒ½ä½¿ç”¨ES6 Moduleçš„æ¨¡å—ï¼Œæé«˜tree shakingæ•ˆç‡
  - ç¦ç”¨ babel-loader çš„æ¨¡å—ä¾èµ–è§£æï¼Œå¦åˆ™ Webpack æ¥æ”¶åˆ°çš„å°±éƒ½æ˜¯è½¬æ¢è¿‡çš„ CommonJS å½¢å¼çš„æ¨¡å—ï¼Œæ— æ³•è¿›è¡Œ tree-shaking
- `scope hoisting`:
  - æ„å»ºåçš„ä»£ç ä¼šå­˜åœ¨å¤§é‡é—­åŒ…ï¼Œé€ æˆä½“ç§¯å¢å¤§ï¼Œè¿è¡Œä»£ç æ—¶åˆ›å»ºçš„å‡½æ•°ä½œç”¨åŸŸå˜å¤šï¼Œå†…å­˜å¼€é”€å˜å¤§ã€‚Scope hoisting å°†æ‰€æœ‰æ¨¡å—çš„ä»£ç æŒ‰ç…§å¼•ç”¨é¡ºåºæ”¾åœ¨ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸé‡Œï¼Œç„¶åé€‚å½“çš„é‡å‘½åä¸€äº›å˜é‡ä»¥é˜²æ­¢å˜é‡åå†²çª
  - å¿…é¡»æ˜¯ES6çš„è¯­æ³•ï¼Œå› ä¸ºæœ‰å¾ˆå¤šç¬¬ä¸‰æ–¹åº“ä»é‡‡ç”¨ CommonJS è¯­æ³•ï¼Œä¸ºäº†å……åˆ†å‘æŒ¥ Scope hoisting çš„ä½œç”¨ï¼Œéœ€è¦é…ç½® mainFields å¯¹ç¬¬ä¸‰æ–¹æ¨¡å—ä¼˜å…ˆé‡‡ç”¨ jsnext:main ä¸­æŒ‡å‘çš„ES6æ¨¡å—åŒ–è¯­æ³•
- `åŠ¨æ€Polyfill`:
  - å»ºè®®é‡‡ç”¨ polyfill-service åªç»™ç”¨æˆ·è¿”å›éœ€è¦çš„polyfillï¼Œç¤¾åŒºç»´æŠ¤ã€‚ (éƒ¨åˆ†å›½å†…å¥‡è‘©æµè§ˆå™¨UAå¯èƒ½æ— æ³•è¯†åˆ«ï¼Œä½†å¯ä»¥é™çº§è¿”å›æ‰€éœ€å…¨éƒ¨polyfill)

